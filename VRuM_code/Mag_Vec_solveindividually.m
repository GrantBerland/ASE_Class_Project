function [G_inv] = Mag_Vec_solveindividually(H)

%H must be 9x3

%For only 9 data sets
%Define sysms unknown
syms G11 G12 G13 G21 G22 G23 G31 G32 G33

H1 = H(1,:);
H2 = H(2,:);
H3 = H(3,:);
H4 = H(4,:);
H5 = H(5,:);
H6 = H(6,:);
H7 = H(7,:);
H8 = H(8,:);
H9 = H(9,:);


%Define the equations

%{
eq_1 = H1(1)*(G11*H1(1)+G21*H1(2)+G31*H1(3))+H1(2)*(G12*H1(1)+G22*H1(2)+G32*H1(3))+ H1(3)*(G13*H1(1)+G23*H1(2)+G33*H1(3)) == 1;
eq_2 = H2(1)*(G11*H2(1)+G21*H2(2)+G31*H2(3))+H2(2)*(G12*H2(1)+G22*H2(2)+G32*H2(3))+ H2(3)*(G13*H2(1)+G23*H2(2)+G33*H2(3)) == 1;
eq_3 = H3(1)*(G11*H3(1)+G21*H3(2)+G31*H3(3))+H3(2)*(G12*H3(1)+G22*H3(2)+G32*H3(3))+ H3(3)*(G13*H3(1)+G23*H3(2)+G33*H3(3)) == 1;
eq_4 = H4(1)*(G11*H4(1)+G21*H4(2)+G31*H4(3))+H4(2)*(G12*H4(1)+G22*H4(2)+G32*H4(3))+ H4(3)*(G13*H4(1)+G23*H4(2)+G33*H4(3)) == 1;
eq_5 = H5(1)*(G11*H5(1)+G21*H5(2)+G31*H5(3))+H5(2)*(G12*H5(1)+G22*H5(2)+G32*H5(3))+ H5(3)*(G13*H5(1)+G23*H5(2)+G33*H5(3)) == 1;
eq_6 = H6(1)*(G11*H6(1)+G21*H6(2)+G31*H6(3))+H6(2)*(G12*H6(1)+G22*H6(2)+G32*H6(3))+ H6(3)*(G13*H6(1)+G23*H6(2)+G33*H6(3)) == 1;
eq_7 = H7(1)*(G11*H7(1)+G21*H7(2)+G31*H7(3))+H7(2)*(G12*H7(1)+G22*H7(2)+G32*H7(3))+ H7(3)*(G13*H7(1)+G23*H7(2)+G33*H7(3)) == 1;
eq_8 = H8(1)*(G11*H8(1)+G21*H8(2)+G31*H8(3))+H8(2)*(G12*H8(1)+G22*H8(2)+G32*H8(3))+ H8(3)*(G13*H8(1)+G23*H8(2)+G33*H8(3)) == 1;
eq_9 = H9(1)*(G11*H9(1)+G21*H9(2)+G31*H9(3))+H9(2)*(G12*H9(1)+G22*H9(2)+G32*H9(3))+ H9(3)*(G13*H9(1)+G23*H9(2)+G33*H9(3)) == 1;

%}

eq_1 = H1(1)*(G11*H1(1)+G21*H1(2)+G31*H1(3))+H1(2)*(G12*H1(1)+G22*H1(2)+G32*H1(3))+ H1(3)*(G13*H1(1)+G23*H1(2)+G33*H1(3)) == 1;
eq_2 = H2(1)*(G11*H2(1)+G21*H2(2)+G31*H2(3))+H2(2)*(G12*H2(1)+G22*H2(2)+G32*H2(3))+ H2(3)*(G13*H2(1)+G23*H2(2)+G33*H2(3)) == 1;
eq_3 = H3(1)*(G11*H3(1)+G21*H3(2)+G31*H3(3))+H3(2)*(G12*H3(1)+G22*H3(2)+G32*H3(3))+ H3(3)*(G13*H3(1)+G23*H3(2)+G33*H3(3)) == 1;
eq_4 = H4(1)*(G11*H4(1)+G21*H4(2)+G31*H4(3))+H4(2)*(G12*H4(1)+G22*H4(2)+G32*H4(3))+ H4(3)*(G13*H4(1)+G23*H4(2)+G33*H4(3)) == 1;
eq_5 = H5(1)*(G11*H5(1)+G21*H5(2)+G31*H5(3))+H5(2)*(G12*H5(1)+G22*H5(2)+G32*H5(3))+ H5(3)*(G13*H5(1)+G23*H5(2)+G33*H5(3)) == 1;
eq_6 = H6(1)*(G11*H6(1)+G21*H6(2)+G31*H6(3))+H6(2)*(G12*H6(1)+G22*H6(2)+G32*H6(3))+ H6(3)*(G13*H6(1)+G23*H6(2)+G33*H6(3)) == 1;
eq_7 = H7(1)*(G11*H7(1)+G21*H7(2)+G31*H7(3))+H7(2)*(G12*H7(1)+G22*H7(2)+G32*H7(3))+ H7(3)*(G13*H7(1)+G23*H7(2)+G33*H7(3)) == 1;
eq_8 = H8(1)*(G11*H8(1)+G21*H8(2)+G31*H8(3))+H8(2)*(G12*H8(1)+G22*H8(2)+G32*H8(3))+ H8(3)*(G13*H8(1)+G23*H8(2)+G33*H8(3)) == 1;
eq_9 = H9(1)*(G11*H9(1)+G21*H9(2)+G31*H9(3))+H9(2)*(G12*H9(1)+G22*H9(2)+G32*H9(3))+ H9(3)*(G13*H9(1)+G23*H9(2)+G33*H9(3)) == 1;



sol_G = vpasolve([eq_1,eq_2, eq_3, eq_4, eq_5, eq_6, eq_7, eq_8],[G11,G21,G31,G12,G22,G32,G13,G23,G33]);


G_11 = double(sol_G.G11)
G_21 = double(sol_G.G21)
G_31 = double(sol_G.G31)

%G_12 = double(sol_G.G12)
G_22 = double(sol_G.G22)
G_23 = double(sol_G.G23)

%G_13 = double(sol_G.G13)
G_23 = double(sol_G.G23)
G_33 = double(sol_G.G33)

G = [G_11,G_21,G_31; G_21,G_22,G_23; G_31, G_23, G_33];

G_inv = inv(G)



end

